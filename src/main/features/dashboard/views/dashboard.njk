{% extends "template.njk" %}

{% from "components/support/macro.njk" import howToGetSupport %}

{% set title = 'Welcome to the Contract Award Service beta' %}
{% block content %}
  {{ CCSBreadcrumbs({
        items: data.breadCrumbs
      }) }}
  <main class="govuk-main-wrapper govuk-main-wrapper--auto-spacing" id="main-content" role="main">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
        <h1 class="govuk-heading-xl">
          {{data.title}}</h1>
      </div>
    </div>
    <div class="govuk-grid-row ccs-page-section">
      <div class="govuk-grid-column-full govuk-grid-column-two-thirds-from-desktop">
        <h3 class="govuk-heading-m">
            Hello, {{ user_firstName }}
        </h3>
        <div class="govuk-inset-text">
          <a class="govuk-link" href="/projects/choose-agreement">
            {{data.buttonText}}
          </a>
          <p class="govuk-body">{{ data.line1 }}</p>
        </div>
      </div>
      <div class="govuk-grid-column-one-third">
        <div class="ccs-callout-panel">
          <h2 class="govuk-heading-m">Related content</h2>
          <p class="govuk-body">
            {% for item in data.related_content %}
              <a class="govuk-link govuk-link--no-visited-state" href="{{ item.href }}" target="_blank" rel="noopener noreferrer" onclick="return false;">{{ item.text }}</a>
            {% endfor %}
          </p>
        </div>
      </div>
    </div>

    <div class="govuk-grid-row govuk-!-margin-bottom-6 govuk-!-margin-top-6">
      <div class="govuk-grid-column-full">
        {% if events.length < 6 %}
          <table class="govuk-table">
            <caption class="govuk-table__caption govuk-heading-m">{{data.subsection2_title}} ({{events.length}})</caption>
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_1}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_2}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_3}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_4}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_5}}</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              {% for event in events %}
                <tr class="govuk-table__row">
                  <th scope="row" class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">
                    <a class="govuk-link" href="/event/management?id={{ event.activeEvent.id }}">{{ event.activeEvent.id }}</a>
                      
                    </p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.projectName | safe }}</p>
                  </th>
                  <td class="govuk-table__cell">{{ event.activeEvent.eventType }}</td>
                  <td class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.lotId }} : {{ event.lotName }}</p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.agreementName }} [{{ event.agreementId }}]</p>
                  </td>
                  <td class="govuk-table__cell">
                    {% if event.activeEvent.tenderPeriod.endDate %}
                      {{ event.activeEvent.tenderPeriod.endDate|date('DD/MM/YYYY') }}
                    {% else %} N/A {% endif %}
                  </td>
                  <td class="govuk-table__cell">
                    {{ event.activeEvent.status }}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          {% elseif events.length > 5 %}
          <table class="govuk-table" id="active-data">
            <caption class="govuk-table__caption govuk-heading-m">{{data.subsection2_title}} ({{events.length}})</caption>
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_1}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_2}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_3}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_4}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_5}}</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              {% for event in events %}
                <tr class="govuk-table__row">
                  <th scope="row" class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">
                      <a class="govuk-link" href="/event/management?id={{ event.activeEvent.id }}">{{ event.activeEvent.id }}</a>
                    </p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.projectName | safe }}</p>
                  </th>
                  <td class="govuk-table__cell">{{ event.activeEvent.eventType }}</td>
                  <td class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.lotId }} : {{ event.lotName }}</p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.agreementName }} [{{ event.agreementId }}]</p>
                  </td>
                  <td class="govuk-table__cell">
                    {% if event.activeEvent.tenderPeriod.endDate %}
                      {{ event.activeEvent.tenderPeriod.endDate|date('DD/MM/YYYY') }}
                    {% else %} N/A {% endif %}
                  </td>
                  <td class="govuk-table__cell">
                    {{ event.activeEvent.status }}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <table class="govuk-table" id="active-data-no-records">
            <caption class="govuk-table__caption govuk-heading-m">{{data.subsection2_title}} (0)</caption>
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_1}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_2}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_3}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_4}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection2_table_th_5}}</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              <tr>
                <td class="govuk-table__cell">
                  <strong class="govuk-tag govuk-tag--blue">
                    You don't have any Running events
                  </strong>
                </td>
                <td class="govuk-table__cell"></td>
                <td class="govuk-table__cell"></td>
                <td class="govuk-table__cell"></td>
                <td class="govuk-table__cell"></td>
              </tr>
            </tbody>
          </table>

        {% endif %}
      </div>
    </div>

    <div class="govuk-grid-row govuk-!-margin-bottom-6">
      <div class="govuk-grid-column-full">
        <h3 class="govuk-heading-m">
          {{data.subsection3_title}}
        </h3>
        <div class="govuk-tabs" data-module="govuk-tabs">
          <h2 class="govuk-tabs__title">
            {{data.subsection3_title}}
          </h2>
          <ul class="govuk-tabs__list">
            <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
              <a class="govuk-tabs__tab" href="#tab-1">{{data.subsection3_tab_1}}</a>
            </li>
            <li class="govuk-tabs__list-item">
              <a class="govuk-tabs__tab" href="#tab-2">{{data.subsection3_tab_2}}</a>
            </li>
          </ul>
          <div class="govuk-tabs__panel" id="tab-1">
            <p>
              {{data.subsection3_tab_1_content}}
            </p>
          </div>
          <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="tab-2">
            <p>
              {{data.subsection3_tab_2_content}}
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="govuk-grid-row govuk-!-margin-bottom-6">
      <div class="govuk-grid-column-full">
        {% if historicalEvents.length > 5 %}
          <table class="govuk-table" id="historical-data">
            <caption class="govuk-table__caption govuk-heading-m">{{data.subsection4_title}} ({{historicalEvents.length}})</caption>
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_1}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_2}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_3}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_4}}</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              {% for event in historicalEvents %}
                <tr class="govuk-table__row">
                  <th scope="row" class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">
                      <a class="govuk-link" href="/event/management?id={{ event.activeEvent.id }}">{{ event.activeEvent.id }}</a>
                    </p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.projectName }}</p>
                  </th>
                  <td class="govuk-table__cell">{{ event.activeEvent.eventType }}</td>
                  <td class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.lotId }} : {{ event.lotName }}</p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.agreementName }} [{{ event.agreementId }}]</p>
                  </td>
                  <td class="govuk-table__cell">
                    {% if event.activeEvent.tenderPeriod.endDate %}
                      {{ event.activeEvent.tenderPeriod.endDate|date('DD/MM/YYYY') }}
                    {% else %} N/A {% endif %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          <p>
            <a class="govuk-link" href="#">{{data.view_Historical}}</a>
          </p>
          {% elseif historicalEvents.length < 6 and historicalEvents.length > 0 %}
          <table class="govuk-table">
            <caption class="govuk-table__caption govuk-heading-m">{{data.subsection4_title}} ({{historicalEvents.length}})</caption>
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_1}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_2}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_3}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_4}}</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              {% for event in historicalEvents %}
                <tr class="govuk-table__row">
                  <th scope="row" class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">
                      <a class="govuk-link" href="/event/management?id={{ event.activeEvent.id }}">{{ event.activeEvent.id }}</a>
                    </p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.projectName }}</p>
                  </th>
                  <td class="govuk-table__cell">{{ event.activeEvent.eventType }}</td>
                  <td class="govuk-table__cell">
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.lotId }} : {{ event.lotName }}</p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ event.agreementName }} [{{ event.agreementId }}]</p>
                  </td>
                  <td class="govuk-table__cell">
                    {% if event.activeEvent.tenderPeriod.endDate %}
                      {{ event.activeEvent.tenderPeriod.endDate|date('DD/MM/YYYY') }}
                    {% else %} N/A {% endif %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          <p>
            <a class="govuk-link" href="#">{{data.view_Historical}}</a>
          </p>
        {% else %}
          <table class="govuk-table">
            <caption class="govuk-table__caption govuk-heading-m">{{data.subsection4_title}} (0)</caption>
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_1}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_2}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_3}}</th>
                <th scope="col" class="govuk-table__header">{{data.subsection4_table_th_4}}</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              <tr>
                <td class="govuk-table__cell">
                  <strong class="govuk-tag govuk-tag--blue">
                    You don't have any Historical Closed events
                  </strong>
                </td>
                <td class="govuk-table__cell"></td>
                <td class="govuk-table__cell"></td>
                <td class="govuk-table__cell"></td>
              </tr>
            </tbody>
          </table>
        {% endif %}
      </div>
    </div>
  </main>
{% endblock %}